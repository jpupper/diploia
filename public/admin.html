<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DiploIA - Admin Panel</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="admin.css">
</head>

<body>
    <div class="app-wrapper">
        <!-- Mobile Sidebar Overlay -->
        <div class="sidebar-overlay" id="sidebar-overlay"></div>
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <span class="logo-icon">‚óÜ</span>
                    <span class="logo-text">DiploIA</span>
                </div>
                <span class="logo-sub">Admin Panel</span>
            </div>
            <nav class="sidebar-nav">
                <a href="#" class="nav-item active" data-section="dashboard" id="nav-dashboard">
                    <span class="nav-icon">üìä</span> Dashboard
                </a>
                <a href="#" class="nav-item" data-section="categories" id="nav-categories">
                    <span class="nav-icon">üìÅ</span> Categor√≠as
                </a>
                <a href="#" class="nav-item" data-section="nodes" id="nav-nodes">
                    <span class="nav-icon">üîµ</span> Nodos
                </a>
                <a href="#" class="nav-item" data-section="connections" id="nav-connections">
                    <span class="nav-icon">üîó</span> Conexiones
                </a>
                <a href="#" class="nav-item" data-section="ranking" id="nav-ranking">
                    <span class="nav-icon">üèÜ</span> Ranking
                </a>
                <a href="#" class="nav-item" data-section="config" id="nav-config">
                    <span class="nav-icon">üó∫Ô∏è</span> Config Mapa
                </a>
                <a href="#" class="nav-item" data-section="space-config" id="nav-space-config">
                    <span class="nav-icon">üöÄ</span> Config Espacio
                </a>
                <a href="#" class="nav-item" data-section="import-export" id="nav-import-export">
                    <span class="nav-icon">üì¶</span> Importar / Exportar
                </a>
            </nav>
            <div class="sidebar-footer">
                <a href="index.html" class="nav-item">
                    <span class="nav-icon">üåê</span> Ver Sitio
                </a>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="topbar">
                <button class="menu-toggle" id="menu-toggle">‚ò∞</button>
                <h2 class="topbar-title" id="topbar-title">Dashboard</h2>
                <div class="topbar-actions">
                    <span class="status-badge" id="status-badge">‚óè Conectado</span>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DASHBOARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="section active" id="section-dashboard">
                    <div class="stats-grid">
                        <div class="stat-card">
                            <div class="stat-icon">üîµ</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stat-total-nodes">0</span>
                                <span class="stat-label">Nodos Totales</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üìÅ</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stat-categories">0</span>
                                <span class="stat-label">Categor√≠as</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üîó</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stat-connections">0</span>
                                <span class="stat-label">Conexiones</span>
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-icon">üèÜ</div>
                            <div class="stat-info">
                                <span class="stat-value" id="stat-rankings">0</span>
                                <span class="stat-label">Rankings</span>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <h3>√öltimos Nodos</h3>
                        <div id="recent-nodes-list" class="items-list"></div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CATEGORIES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="section" id="section-categories">
                    <div class="section-header">
                        <h3>Categor√≠as</h3>
                        <button class="btn btn-primary" id="btn-add-category">+ Nueva Categor√≠a</button>
                    </div>
                    <div id="categories-list" class="items-grid"></div>

                    <!-- Add Category Modal -->
                    <div class="modal-overlay" id="modal-add-category">
                        <div class="modal">
                            <div class="modal-header">
                                <h3>Nueva Categor√≠a</h3>
                                <button class="modal-close" data-close="modal-add-category">‚úï</button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label>ID (slug, sin espacios)</label>
                                    <input type="text" id="cat-id" placeholder="ej: mi-categoria">
                                </div>
                                <div class="form-group">
                                    <label>Nombre</label>
                                    <input type="text" id="cat-label" placeholder="ej: Mi Categor√≠a">
                                </div>
                                <div class="form-group">
                                    <label>Descripci√≥n</label>
                                    <textarea id="cat-info" rows="3"
                                        placeholder="Descripci√≥n de la categor√≠a..."></textarea>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-ghost" data-close="modal-add-category">Cancelar</button>
                                <button class="btn btn-primary" id="btn-save-category">Guardar</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê NODES ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="section" id="section-nodes">
                    <div class="section-header">
                        <h3>Nodos</h3>
                        <div class="section-actions">
                            <select id="filter-category" class="select-input">
                                <option value="">Todas las categor√≠as</option>
                            </select>
                            <input type="text" id="search-nodes" class="search-input" placeholder="Buscar nodo...">
                            <button class="btn btn-primary" id="btn-add-node">+ Nuevo Nodo</button>
                        </div>
                    </div>
                    <div id="nodes-list" class="items-list"></div>

                    <!-- Add/Edit Node Modal -->
                    <div class="modal-overlay" id="modal-node">
                        <div class="modal modal-large">
                            <div class="modal-header">
                                <h3 id="modal-node-title">Nuevo Nodo</h3>
                                <button class="modal-close" data-close="modal-node">‚úï</button>
                            </div>
                            <div class="modal-body">
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>ID (slug)</label>
                                        <input type="text" id="node-id" placeholder="ej: mi-herramienta">
                                    </div>
                                    <div class="form-group">
                                        <label>Nombre</label>
                                        <input type="text" id="node-label" placeholder="ej: Mi Herramienta">
                                    </div>
                                </div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label>Tipo</label>
                                        <select id="node-type" class="select-input">
                                            <option value="tool">Herramienta (nodo normal)</option>
                                            <option value="category">Categor√≠a</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label>Categor√≠a Padre</label>
                                        <select id="node-parent" class="select-input">
                                            <option value="">Sin categor√≠a padre</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label>URL</label>
                                    <input type="text" id="node-url" placeholder="https://ejemplo.com">
                                </div>
                                <div class="form-group">
                                    <label>Descripci√≥n (texto plano)</label>
                                    <textarea id="node-info" rows="3" placeholder="Descripci√≥n breve..."></textarea>
                                </div>
                                <div class="form-group">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 6px;">
                                        <label style="margin-bottom: 0;">Info HTML (para mostrar en popups)</label>
                                        <button class="btn btn-sm btn-accent" id="btn-sync-html" type="button"
                                            title="Generar HTML desde la descripci√≥n">‚ö° Sync HTML</button>
                                    </div>
                                    <textarea id="node-infohtml" rows="5"
                                        placeholder="<h3>T√≠tulo</h3><p>Descripci√≥n...</p>"></textarea>
                                </div>
                                <div class="form-group">
                                    <label>Conexiones Secundarias</label>
                                    <div class="secondary-conn-picker" id="secondary-conn-picker">
                                        <div class="conn-tags" id="conn-tags"></div>
                                        <div class="conn-search-wrap">
                                            <input type="text" id="conn-search-input" class="search-input"
                                                placeholder="Buscar nodo por nombre o ID..." autocomplete="off">
                                            <div class="conn-search-results" id="conn-search-results"></div>
                                        </div>
                                    </div>
                                    <input type="hidden" id="node-secondary">
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-ghost" data-close="modal-node">Cancelar</button>
                                <button class="btn btn-primary" id="btn-save-node">Guardar</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONNECTIONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="section" id="section-connections">
                    <div class="section-header">
                        <h3>Conexiones</h3>
                        <button class="btn btn-primary" id="btn-add-connection">+ Nueva Conexi√≥n</button>
                    </div>
                    <div class="card">
                        <p class="hint-text">Aqu√≠ se muestran todas las conexiones secundarias entre nodos. Las
                            conexiones primarias (categor√≠a ‚Üí hijo) se gestionan autom√°ticamente.</p>
                    </div>
                    <div id="connections-list" class="items-list"></div>

                    <!-- Add Connection Modal -->
                    <div class="modal-overlay" id="modal-connection">
                        <div class="modal">
                            <div class="modal-header">
                                <h3>Nueva Conexi√≥n</h3>
                                <button class="modal-close" data-close="modal-connection">‚úï</button>
                            </div>
                            <div class="modal-body">
                                <div class="form-group">
                                    <label>Nodo Origen</label>
                                    <input type="text" id="conn-source-search" class="search-input"
                                        placeholder="Filtrar nodos..." autocomplete="off" style="margin-bottom:6px;">
                                    <select id="conn-source" class="select-input" size="6"></select>
                                </div>
                                <div class="form-group">
                                    <label>Nodo Destino</label>
                                    <input type="text" id="conn-target-search" class="search-input"
                                        placeholder="Filtrar nodos..." autocomplete="off" style="margin-bottom:6px;">
                                    <select id="conn-target" class="select-input" size="6"></select>
                                </div>
                                <div class="form-group">
                                    <label>Tipo</label>
                                    <select id="conn-type" class="select-input">
                                        <option value="secondary">Secundaria</option>
                                        <option value="primary">Primaria</option>
                                    </select>
                                </div>
                            </div>
                            <div class="modal-footer">
                                <button class="btn btn-ghost" data-close="modal-connection">Cancelar</button>
                                <button class="btn btn-primary" id="btn-save-connection">Guardar</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê RANKING ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="section" id="section-ranking">
                    <div class="section-header">
                        <h3>Ranking de Jugadores</h3>
                    </div>
                    <div id="ranking-list" class="items-list"></div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONFIGURATION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="section" id="section-config">
                    <div class="section-header">
                        <h3>Configuraci√≥n del Mapa</h3>
                        <button class="btn btn-primary" id="btn-save-config">üíæ Guardar Configuraci√≥n</button>
                    </div>

                    <div class="cards-row">
                        <div class="card">
                            <h4>üìè Tama√±os de Nodos</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Nodo Central (Ra√≠z)</label>
                                    <input type="number" id="cfg-rootNodeSize">
                                </div>
                                <div class="form-group">
                                    <label>Categor√≠as</label>
                                    <input type="number" id="cfg-primaryNodeSize">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Herramientas (Nodos)</label>
                                    <input type="number" id="cfg-secondaryNodeSize">
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <h4>üî§ Tama√±os de Fuente</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>ID Ra√≠z</label>
                                    <input type="number" id="cfg-rootFontSize">
                                </div>
                                <div class="form-group">
                                    <label>Categor√≠as</label>
                                    <input type="number" id="cfg-categoryFontSize">
                                </div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Nodos</label>
                                    <input type="number" id="cfg-nodeFontSize">
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h4>üìç Distancias Globales</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Distancia Ra√≠z ‚Üî Categor√≠as</label>
                                <input type="number" id="cfg-primaryDistance">
                            </div>
                            <div class="form-group">
                                <label>Distancia Entre Nodos Secundarios</label>
                                <input type="number" id="cfg-secondaryNodeDist">
                            </div>
                        </div>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h4>üé≠ Animaciones y Popups</h4>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Delay Categor√≠a (ms)</label>
                                <input type="number" id="cfg-animCategoryDelay">
                            </div>
                            <div class="form-group">
                                <label>Delay Nodo (ms)</label>
                                <input type="number" id="cfg-animNodeDelay">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Velocidad Transici√≥n (ms)</label>
                                <input type="number" id="cfg-animTransitionSpeed">
                            </div>
                            <div class="form-group">
                                <label>Velocidad Expansi√≥n (ms)</label>
                                <input type="number" id="cfg-animNodeExpansionSpeed">
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label>Fuente T√≠tulo Popup</label>
                                <input type="number" id="cfg-popupTitleFontSize">
                            </div>
                            <div class="form-group">
                                <label>Fuente Texto Popup</label>
                                <input type="number" id="cfg-popupTextFontSize">
                            </div>
                        </div>
                    </div>

                    <div class="card" style="margin-top: 20px;">
                        <h4>üìÅ Distancias por Categor√≠a</h4>
                        <p class="hint-text" style="margin-bottom: 15px;">Configura las distancias espec√≠ficas para cada
                            categor√≠a existente en el universo.</p>
                        <div id="category-distances-list" class="items-list">
                            <!-- Se cargar√° din√°micamente -->
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SPACE CONFIGURATION ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="section" id="section-space-config">
                    <div class="section-header">
                        <h3>Configuraci&oacute;n del Espacio 3D</h3>
                        <button class="btn btn-primary" id="btn-save-space-config">&#x1F4BE; Guardar Config Espacio</button>
                    </div>

                    <!-- Category Setup (dynamic) -->
                    <div class="card" style="margin-top:12px;">
                        <h4>&#x1F4C1; Categor&iacute;as</h4>
                        <p class="hint-text" style="margin-bottom:15px;">Distancia al centro, distancia entre planetas y color de cada categor&iacute;a.</p>
                        <div id="sc-category-list" class="items-list"></div>
                    </div>

                    <!-- Game Scoring -->
                    <div class="cards-row" style="margin-top:12px;">
                        <div class="card">
                            <h4>&#x1F3AE; Carrera Estelar</h4>
                            <div class="form-row">
                                <div class="form-group"><label>Tiempo de juego (seg)</label><input type="number" step="any" id="sc-game-gameTime"></div>
                                <div class="form-group"><label>Tiempo eval/pregunta (seg)</label><input type="number" step="any" id="sc-game-evalTimePerQuestion"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Pts Ruta Correcta</label><input type="number" step="any" id="sc-game-pointsRouteCorrect"></div>
                                <div class="form-group"><label>Pts Random Correcta</label><input type="number" step="any" id="sc-game-pointsRandomCorrect"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Pts Incorrecta</label><input type="number" step="any" id="sc-game-pointsWrong"></div>
                                <div class="form-group"><label>Collect Time (seg)</label><input type="number" step="any" id="sc-game-collectTime"></div>
                            </div>
                        </div>
                        <div class="card">
                            <h4>&#x1F30D; Planet Visitor</h4>
                            <div class="form-row">
                                <div class="form-group"><label>Total Planetas</label><input type="number" step="any" id="sc-game-pvTotalPlanets"></div>
                                <div class="form-group"><label>Pts por Visita</label><input type="number" step="any" id="sc-game-pvPointsPerVisit"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Pts Correcta</label><input type="number" step="any" id="sc-game-pvPointsCorrect"></div>
                                <div class="form-group"><label>Pts Incorrecta</label><input type="number" step="any" id="sc-game-pvPointsWrong"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Dist. C√°mara Orbital (unidades)</label><input type="number" step="any" id="sc-game-pvStopDistance"></div>
                                <div class="form-group"><label>Auto-avance (seg)</label><input type="number" step="any" id="sc-game-pvAutoAdvanceTime"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Tama√±o fuente panel info (px)</label><input type="number" step="1" id="sc-game-pvInfoFontSize"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Ship -->
                    <div class="card" style="margin-top:12px;">
                        <h4>&#x1F680; Nave Espacial</h4>
                        <div class="form-row">
                            <div class="form-group"><label>Max Speed</label><input type="number" step="any" id="sc-ship-maxSpeed"></div>
                            <div class="form-group"><label>Acceleration</label><input type="number" step="any" id="sc-ship-acceleration"></div>
                            <div class="form-group"><label>Drag</label><input type="number" step="any" id="sc-ship-drag"></div>
                        </div>
                        <div class="form-row">
                            <div class="form-group"><label>Turn Speed</label><input type="number" step="any" id="sc-ship-turnSpeed"></div>
                            <div class="form-group"><label>Boost Multiplier</label><input type="number" step="any" id="sc-ship-boostMultiplier"></div>
                            <div class="form-group"><label>Mouse Sensitivity</label><input type="number" step="any" id="sc-ship-mouseSensitivity"></div>
                        </div>
                    </div>

                    <!-- Scene & Stars -->
                    <div class="cards-row" style="margin-top:12px;">
                        <div class="card">
                            <h4>&#x1F3AC; Escena</h4>
                            <div class="form-row">
                                <div class="form-group"><label>Fog Color (hex)</label><input type="text" id="sc-scene-fogColor" placeholder="0x06060e"></div>
                                <div class="form-group"><label>Fog Density</label><input type="number" step="any" id="sc-scene-fogDensity"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Ambient Color (hex)</label><input type="text" id="sc-scene-ambientColor" placeholder="0x111122"></div>
                                <div class="form-group"><label>Ambient Intensity</label><input type="number" step="any" id="sc-scene-ambientIntensity"></div>
                            </div>
                        </div>
                        <div class="card">
                            <h4>&#x2B50; Estrellas</h4>
                            <div class="form-row">
                                <div class="form-group"><label>Cantidad</label><input type="number" step="any" id="sc-stars-count"></div>
                                <div class="form-group"><label>Dist. M&iacute;n</label><input type="number" step="any" id="sc-stars-minDistance"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group"><label>Dist. M&aacute;x</label><input type="number" step="any" id="sc-stars-maxDistance"></div>
                                <div class="form-group"><label>Tama&ntilde;o Base</label><input type="number" step="any" id="sc-stars-baseSize"></div>
                            </div>
                        </div>
                    </div>

                    <!-- Connections -->
                    <div class="card" style="margin-top:12px;">
                        <h4>&#x1F517; Conexiones</h4>
                        <div class="form-row">
                            <div class="form-group"><label>Trace Duration (seg)</label><input type="number" step="any" id="sc-connections-traceDuration"></div>
                            <div class="form-group"><label>Trace Sphere Radius</label><input type="number" step="any" id="sc-connections-traceSphereRadius"></div>
                            <div class="form-group"><label>Trace Sphere Glow Mult</label><input type="number" step="any" id="sc-connections-traceSphereGlowMult"></div>
                        </div>
                    </div>
                </section>

                <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê IMPORT / EXPORT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
                <section class="section" id="section-import-export">
                    <div class="section-header">
                        <h3>Importar / Exportar Datos</h3>
                    </div>
                    <div class="cards-row">
                        <div class="card">
                            <h4>üì• Importar desde JSON existente</h4>
                            <p>Carga el archivo <code>mapa_herramientas_data.json</code> que ya tiene todos los nodos.
                            </p>
                            <input type="file" id="import-file" accept=".json" class="file-input">
                            <button class="btn btn-primary" id="btn-import" style="margin-top:12px;">Importar
                                Archivo</button>
                            <div id="import-status" class="status-message"></div>
                        </div>
                        <div class="card">
                            <h4>üì• Importar desde mapa_data.js (legacy)</h4>
                            <p>Importa autom√°ticamente los datos del archivo JS existente que ya est√° en el servidor.
                            </p>
                            <button class="btn btn-accent" id="btn-import-legacy">Importar datos legacy</button>
                            <div id="import-legacy-status" class="status-message"></div>
                        </div>
                        <div class="card">
                            <h4>üì§ Exportar Datos</h4>
                            <p>Descarga toda la base de datos de nodos como archivo JSON.</p>
                            <button class="btn btn-primary" id="btn-export">Descargar JSON</button>
                        </div>
                    </div>
                </section>
            </div>
        </main>
    </div>

    <!-- Toast Notification -->
    <div class="toast-container" id="toast-container"></div>

    <script src="admin.js"></script>
</body>

</html>